"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.login=exports.register=void 0;var _Admin=_interopRequireDefault(require("../models/Admin.js")),_bcryptjs=_interopRequireDefault(require("bcryptjs")),_jsonwebtoken=_interopRequireDefault(require("jsonwebtoken"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var register=function(r,s){var t,n,a,u,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.body,n=t.email,a=t.password,e.prev=1,e.next=4,regeneratorRuntime.awrap(_Admin.default.findOne({email:n}));case 4:if(e.sent)return e.abrupt("return",s.status(404).json({Message:"User already exists"}));e.next=7;break;case 7:return u=_bcryptjs.default.hashSync(a,10),o=new _Admin.default({email:n,password:u}),e.next=11,regeneratorRuntime.awrap(o.save());case 11:s.status(201).json({message:"Registered successfully"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),s.status(500).json({message:"Intrenal server error",error:e.t0.message});case 17:case"end":return e.stop()}},null,null,[[1,14]])};exports.register=register;var login=function(r,s){var t,n,a,u,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.body,n=t.email,a=t.password,e.prev=1,e.next=4,regeneratorRuntime.awrap(_Admin.default.findOne({email:n}));case 4:if(u=e.sent){e.next=7;break}return e.abrupt("return",s.status(404).json({message:"User not found"}));case 7:if(_bcryptjs.default.compareSync(a,u.password)){e.next=12;break}return e.abrupt("return",s.status(400).json({message:"Incorrect password"}));case 12:o=_jsonwebtoken.default.sign({user:u.email,id:u._id},process.env.JWT_KEY,{expiresIn:"1d"}),s.status(200).json({message:"Logged in",token:o});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),s.status(500).json({Message:"Internal server error",Error:e.t0.message});case 19:case"end":return e.stop()}},null,null,[[1,16]])};exports.login=login;
//# sourceMappingURL=AuthController.min.js.map
